!function(e){var n=function(){"use strict";function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function n(e,n,t){if(n)i(e.prototype,n);if(t)i(e,t);return e}var o=function(){function i(e,n,t){s(this,i);this._autobahn=e;this._listeners={};this._session=null;this._connect(n,t)}n(i,[{key:"autobahn",get:function e(){return this._autobahn}},{key:"session",get:function e(){return this._session}},{key:"isConnected",value:function e(){return this._session!==null}},{key:"off",value:function e(n,t){if(!(this._listeners[n]instanceof Array))return;var i,s=this._listeners[n],o=s.length;for(i=0;i<o;i++)if(s[i]===t){s.splice(i,1);break}}},{key:"on",value:function e(n,t){if(typeof this._listeners[n]==="undefined")this._listeners[n]=[];this._listeners[n].push(t)}},{key:"publishToTopic",value:function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!this.isConnected())throw new Error("Websocket session is not active, cannot publish to URI");this._session.publish(n,t)}},{key:"rpcCall",value:function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!this.isConnected())throw new Error("Websocket session is not active, cannot perform RPC call");return this._session.call(n,t)}},{key:"subscribeToChannel",value:function e(n,t){if(!this.isConnected())throw new Error("Websocket session is not active, cannot subscribe to channel");try{this._session.subscribe(n,t)}catch(e){if(e.message.indexOf(" already subscribed for topic ")!==-1);else throw e}}},{key:"unsubscribeFromChannel",value:function e(n,t){if(!this.isConnected())throw new Error("Websocket session is not active, cannot unsubscribe from channel");try{this._session.unsubscribe(n,t)}catch(e){if(e.message.indexOf("not subscribed to topic ")!==-1||e.message.indexOf(" subscribed on topic ")!==-1);else throw e}}},{key:"_connect",value:function e(n){var i=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this._autobahn.connect(n,function(e){i._session=e;i._fire("socket/connect",e)},function(e,n,t){i._session=null;i._fire("socket/disconnect",{code:e,reason:n})},t)}},{key:"_fire",value:function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!(this._listeners[n]instanceof Array))return;var i,s=this._listeners[n],o=s.length;for(i=0;i<o;i++)s[i].call(this,t)}}],[{key:"connect",value:function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(typeof global.ab==="undefined")throw new Error("GosSocket requires AutobahnJS to be loaded.");return new i(global.ab,n,t)}}]);return i}(),e,t=new(function(){function e(){s(this,e)}n(e,[{key:"connect",value:function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return o.connect(n,t)}}],[{key:"instance",get:function e(){return t}}]);return e}());return t}();"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n:e.WS=n}(this);